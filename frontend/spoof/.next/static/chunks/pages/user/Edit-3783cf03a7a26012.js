(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{5041:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/Edit",function(){return a(845)}])},845:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var n=a(5893),r=a(7294),i=a(9979),s=a(8962),o=a(4246),l=a(4440),u=a(4466),h=a(3465),d=a(8163),c=a(4191),m=a(747),f=a(6627),x=a.n(f),p=a(7066),v=a(9496),Z=a(1163);let j=(0,c.Z)();function g(){let e="http://localhost:3002",t=sessionStorage.getItem("user"),a=sessionStorage.getItem("bearerToken"),c=(0,Z.useRouter)(),[f,g]=(0,r.useState)({usuario:"",telefone:""}),[b,w]=(0,r.useState)({email:"",senha:""}),[C,P]=(0,r.useState)(!1),[y,_]=(0,r.useState)(""),E=e=>{let{name:t,value:a}=e.target;g(e=>({...e,[t]:a}))},N=e=>{let{name:t,value:a}=e.target;w(e=>({...e,[t]:a}))};(0,r.useEffect)(()=>{(async()=>{try{let n=(await p.Z.get(e+"/users/"+t,{headers:{Authorization:"Bearer "+a}})).data.user;g({usuario:n.usuario,telefone:n.telefone})}catch(e){console.error(e)}})()},[e,t,a]);let S=async n=>{if(n.preventDefault(),""===f.usuario||""===f.telefone){(0,v.yv)("Nome de usu\xe1rio e telefone s\xe3o obrigat\xf3rios",{variant:"error"});return}if(b.senha!==y){(0,v.yv)("Senhas n\xe3o coincidem",{variant:"error"});return}try{await p.Z.patch(e+"/users/"+t+"/update/basicData",f,{headers:{Authorization:"Bearer "+a}}),(0!==b.email.length||0!==b.senha.length)&&await p.Z.patch(e+"/users/"+t+"/update/sensitiveData",b,{headers:{Authorization:"Bearer "+a}}),(0,v.yv)("Perfil salvo",{variant:"success"}),c.push("/")}catch(e){(0,v.yv)("N\xe3o foi poss\xedvel editar usu\xe1rio",{variant:"error"})}};return(0,n.jsx)(m.Z,{theme:j,children:(0,n.jsxs)(i.Z,{component:"main",maxWidth:"xs",children:[(0,n.jsx)(s.ZP,{}),(0,n.jsx)(o.Z,{component:"h1",variant:"h5",sx:{marginTop:5},children:"Editar Perfil"}),(0,n.jsxs)(l.Z,{component:"form",noValidate:!0,onSubmit:S,sx:{mt:3},children:[(0,n.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{required:!0,fullWidth:!0,id:"usuario",label:"Usu\xe1rio",name:"usuario",autoComplete:"username",value:f.usuario,onChange:E})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(x(),{mask:"(99) 99999-9999",value:f.telefone,onChange:E,children:(0,n.jsx)(h.Z,{required:!0,fullWidth:!0,id:"telefone",label:"Telefone",name:"telefone",autoComplete:"tel",type:"tel"})})})]}),(0,n.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,children:C?(0,n.jsx)(d.Z,{type:"button",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:e=>{e.preventDefault(),P(!1)},children:"Ocultar"}):(0,n.jsx)(d.Z,{type:"button",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:e=>{e.preventDefault(),P(!0)},children:"Editar credenciais"})}),C&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{required:!0,fullWidth:!0,id:"email",label:"Novo email",name:"email",autoComplete:"email",value:b.email,onChange:N})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{required:!0,fullWidth:!0,name:"senha",label:"Nova senha",type:"password",id:"senha",autoComplete:"new-password",value:b.senha,onChange:N})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{required:!0,fullWidth:!0,name:"senha",label:"Confirmar senha",type:"password",id:"novasenha",autoComplete:"new-password",value:y,onChange:e=>_(e.target.value)})})]})]}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Salvar Perfil"})})]})]})})}}},function(e){e.O(0,[187,355,888,774,179],function(){return e(e.s=5041)}),_N_E=e.O()}]);